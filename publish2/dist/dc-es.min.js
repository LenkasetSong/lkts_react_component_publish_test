import e,{Component as t}from"react";import{Button as n,Form as a,Tooltip as r,Input as i,InputNumber as l,Space as s,Radio as o,Select as m,Switch as c,Collapse as u}from"antd";import p from"prop-types";function d(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&a.firstChild?a.insertBefore(r,a.firstChild):a.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}function h(t){return e.createElement("button",{style:{color:"red"},className:"btn-style"},t.name)}d(".btn-style{border-color:#00f;margin:10px}");var y="AnotherButton-module_btn__3h7Ml";function g(t){return e.createElement(n,{className:y},t.name)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function C(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}d(".AnotherButton-module_btn__3h7Ml{width:450px;height:30px;margin:10px;color:red}");var b=0,O=1,S=2,x=3,N=4,k=5;d("");var P=function(t){function n(e){var n;return f(E(n=t.call(this,e)||this),"Id",Math.trunc(16777216*Math.random()).toString()),n}C(n,t);var l=n.prototype;return l.textChanged=function(e){var t=this.props;(0,t.OnTextChanged)(t.name,e.target.value)},l.render=function(){var t=this.props,n=t.displayName,l=t.description,s=t.text;return e.createElement(a.Item,{label:e.createElement(r,{title:l},""+n)},e.createElement(i,{id:this.Id,defaultValue:s,placeholder:"请输入字符串...",onChange:this.textChanged.bind(this)}))},n}(t);P.propTypes={name:p.string,displayName:p.string,description:p.string,text:p.string,OnTextChanged:p.func};d("");var I=function(t){function n(e){var n;return f(E(n=t.call(this,e)||this),"Id",Math.trunc(16777216*Math.random()).toString()),f(E(n),"limitDecimals",(function(e){var t=/^(-)*(\d+)\.(\d\d).*$/;return"string"==typeof e?isNaN(Number(e))?"":e.replace(t,"$1$2.$3"):"number"==typeof e?isNaN(e)?"":String(e).replace(t,"$1$2.$3"):""})),n.state={currentValue:e.value},n}C(n,t);var i=n.prototype;return i.valueChanged=function(e){var t=this.props,n=t.max,a=t.min,r=t.name,i=t.OnValueChanged;/^[0-9]+.?[0-9]*/.test(e)&&(e<=n||e>=a)&&(this.setState({currentValue:e}),null==i||i(r,e))},i.render=function(){var t=this.props,n=t.max,i=t.min,o=t.displayName,m=t.description,c=t.isInteger,u=t.unit,p=this.state.currentValue;return e.createElement(a.Item,{label:e.createElement(r,{title:m},""+o)},e.createElement(a.Item,{noStyle:!0,rules:[{required:!0,message:"该属性不能为空"}]},e.createElement(l,{min:i||0,max:n||Number.MAX_SAFE_INTEGER,value:p,step:c?1:.01,onChange:this.valueChanged.bind(this)})),e.createElement(s,{style:{marginLeft:10},size:"large"},e.createElement("div",null,""+(void 0!==u?u:"")),e.createElement("div",{style:{color:"orangered"}},i&&n?i+"~"+n:"",c?"整数":"小数")))},n}(t);I.propTypes={name:p.string,displayName:p.string,description:p.string,value:p.number,min:p.number,max:p.number,unit:p.string,isInteger:p.bool,OnValueChanged:p.func};var M=o.Button,V=o.Group,L=function(t){function n(e){var n;return f(E(n=t.call(this,e)||this),"Id",Math.trunc(16777216*Math.random()).toString()),n}C(n,t);var i=n.prototype;return i.selectOptionChanged=function(e){var t=this.props;(0,t.OnSelectionChanged)(t.name,e)},i.selectRadioChanged=function(e){var t=this.props;(0,t.OnSelectionChanged)(t.name,e.target.value)},i.renderOptions=function(){var t=this.props,n=t.items,a=t.displayStrs;return n.map((function(t,n){return e.createElement(m.Option,{key:n,value:t},a[n])}))},i.renderGroups=function(){var t=this.props,n=t.items,a=t.displayStrs;return n.map((function(t,n){return e.createElement(M,{key:n,value:t},a[n])}))},i.render=function(){var t=this.props,n=t.description,i=t.items,l=t.displayName,s=t.selectedItem;return e.createElement(a.Item,{label:e.createElement(r,{title:n},""+l)},i.length<=3?e.createElement(V,{key:this.Id,defaultValue:s,onChange:this.selectRadioChanged.bind(this)},this.renderGroups()):e.createElement(m,{key:this.Id,defaultValue:s,onChange:this.selectOptionChanged.bind(this)},this.renderOptions()))},n}(t);L.propTypes={name:p.string,displayName:p.string,description:p.string,selectedItem:p.any,displayStrs:p.array,items:p.array,OnSelectionChanged:p.func};var w=function(t){function n(e){var n;f(E(n=t.call(this,e)||this),"Id",Math.trunc(16777216*Math.random()).toString());var a=n.props.bool;return n.state={currentBool:a},n}C(n,t);var i=n.prototype;return i.boolChanged=function(e){var t=this.props;(0,t.OnBoolChanged)(t.name,e),this.setState({currentBool:e})},i.render=function(){var t=this.props,n=t.displayName,i=t.description,l=t.displayStrs,s=t.items,o=this.state.currentBool;return e.createElement(a.Item,{label:e.createElement(r,{title:i},""+n)},e.createElement(a.Item,{noStyle:!0,rules:[{required:!0,message:"该属性不能为空"}]},e.createElement(c,{checked:o,onChange:this.boolChanged.bind(this)})),e.createElement(r,{title:"功能开关"},e.createElement("a",{href:"##",style:{margin:"0px 20px"}},l[s.indexOf(o)])))},n}(t);w.propTypes={name:p.string,displayName:p.string,description:p.string,bool:p.bool,displayStrs:p.array,items:p.array,OnBoolChanged:p.func};d(".normal-button{border:0;background:transparent;margin-right:10px}.normal-button :hover{color:#3200e9}.normal-button :active{color:rgba(255,0,179,.61)}");var B=function(t){function r(e){var n;return f(E(n=t.call(this,e)||this),"Id",Math.trunc(16777216*Math.random()).toString()),f(E(n),"itemsCache",[]),f(E(n),"template",[]),f(E(n),"textChanged",(function(e,t,a,r){var i=r.target.value;n.itemsCache[e][""+a]=i})),f(E(n),"valueChanged",(function(e,t,a,r){/^[0-9]+.?[0-9]*/.test(r)&&(n.itemsCache[e][""+a]=r)})),f(E(n),"selectionChanged",(function(e,t,a,r){n.itemsCache[e][""+a]=r})),f(E(n),"deleteClick",(function(e){if(n.itemsCache.length>0){var t=n.state.itemstag;n.itemsCache.splice(e,1),n.setState({itemstag:t+1})}})),f(E(n),"addClick",(function(){var e=n.state.itemstag,t=n.props.items;if(t&&t.length>0)n.itemsCache.push(JSON.parse(JSON.stringify(t[0])));else{var a={};n.template.forEach((function(e){a[e.name]=e.default})),console.log(a),n.itemsCache.push(a)}n.setState({itemstag:e+1})})),f(E(n),"saveClick",(function(){var e=n.props,t=e.name;(0,e.OnListChanged)(t,n.itemsCache)})),n.state={itemstag:0},n.template=e.template,n.itemsCache=[].concat(e.items),n}C(r,t);var o=r.prototype;return o.renderList=function(t,n){var a=this;return this.template.map((function(r,o){var c=Math.trunc(16777216*Math.random()).toString(),u=b;switch(null===r.template||0===r.template.length?null!==r.values&&r.values.length>0?(u=x,5!==r.type&&"bool"!==r.type||(u=N)):(1!==r.type&&2!==r.type&&"float"!==r.type&&"double"!==r.type||(u=S),3!==r.type&&4!==r.type&&"int"!==r.type||(u=O)):u=k,u){case b:return e.createElement("tr",{key:c},e.createElement("td",{style:{textAlign:"right"}},r.displayName+":"),e.createElement("td",{colSpan:2,style:{padding:3}},e.createElement(i,{defaultValue:t[""+r.name],placeholder:"请输入字符串...",onChange:a.textChanged.bind(a,n,o,r.name)})));case S:return e.createElement("tr",{key:c},e.createElement("td",{style:{textAlign:"right"}},r.displayName+":"),e.createElement("td",{style:{padding:3}},e.createElement(l,{style:{width:"90%"},min:r.minimum,max:r.maximum,defaultValue:t[""+r.name],step:.01,onChange:a.valueChanged.bind(a,n,o,r.name)})),e.createElement("td",null,e.createElement(s,{size:"middle"},e.createElement("div",null,""+(void 0!==r.Unit?r.Unit:"")),e.createElement("div",{style:{color:"orangered"}},r.minimum&&r.maximum?r.minimum+"~"+r.maximum:""))));case x:return e.createElement("tr",{key:c},e.createElement("td",{style:{textAlign:"right"}},r.displayName+":"),e.createElement("td",{colSpan:2,style:{padding:3}},e.createElement(m,{defaultValue:t[""+r.name],style:{width:"90%"},onChange:a.selectionChanged.bind(a,n,o,r.name)},r.values.map((function(t,n){var a=Math.trunc(16777216*Math.random()).toString();return e.createElement(m.Option,{key:a,value:t},r.displayValues[n])})))));default:return null}}))},o.render=function(){var t=this,r=this.props.displayName;return e.createElement(a.Item,{label:r+" :"},this.itemsCache.map((function(a,i){var l=Math.trunc(16777216*Math.random()).toString();return e.createElement("table",{key:l,style:{border:"1px solid #ccc",marginBottom:"5px",width:"100%"}},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null),e.createElement("th",null),e.createElement("th",null))),e.createElement("tbody",null,e.createElement("tr",{key:a.name},e.createElement("td",{colSpan:2,style:{color:"red",textAlign:"center"}},r+":"+(i+1)),e.createElement("td",{style:{textAlign:"right"}},e.createElement(n,{style:{color:"red",margin:"3px"},onClick:t.deleteClick.bind(t,i)},"删除"))),t.renderList(a,i)))})),e.createElement(n,{style:{margin:"5px",color:"blue"},onClick:this.addClick.bind(this)},"添加"),e.createElement(n,{style:{margin:"5px"},onClick:this.saveClick.bind(this)},"保存"))},r}(t);B.propTypes={name:p.string,displayName:p.string,template:p.any,items:p.array,OnListChanged:p.func};var T=u.Panel,_=function(t){function n(e){var n;f(E(n=t.call(this,e)||this),"index",0),f(E(n),"OnSetPropertyList",void 0),f(E(n),"OnParamsChanged",void 0),f(E(n),"layout",{labelCol:{span:6},wrapperCol:{span:12}}),f(E(n),"onPropertyChanged",(function(e,t){var a=n.state.properties,r=null==a?void 0:a.find((function(t){return t.name===e}));if(void 0!==r)if(null!==r.template&&r.template.length>0){var i=JSON.parse(JSON.stringify(r.parameters));r.parameters=t,n.OnParamsChanged(a,e,i,t)}else{var l=r.value;r.value=t,n.OnParamsChanged(a,e,l,t)}})),f(E(n),"groupBy",(function(e,t){var n={};return e.forEach((function(e){var a=JSON.stringify(t(e));n[a]=n[a]||[],n[a].push(e)})),Object.keys(n).map((function(e){return{name:JSON.parse(e),data:n[e]}}))})),f(E(n),"onFinish",(function(){}));var a=n.props,r=a.params,i=a.OnSetPropertyList,l=a.OnParamsChanged;return n.state={properties:r},n.OnSetPropertyList=i,n.OnParamsChanged=l,n}C(n,t),n.getDerivedStateFromProps=function(e,t){var n=e.params;return JSON.stringify(n)!==JSON.stringify(t.properties)?{properties:n}:null};var r=n.prototype;return r.onSetPropertyList=function(){var e=this.state.properties;this.OnSetPropertyList(e)},r.renderGroup=function(){var t=this,n=this.state.properties;if(n){var r=this.groupBy(n,(function(e){return e.category})).map((function(n,r){return e.createElement(T,{header:n.name,key:r+1},e.createElement(a,v({},t.layout,{className:"ant-form-horizontal"}),t.renderList(n.data)))}));return e.createElement(u,{defaultActiveKey:["1","2"]},r)}return e.createElement(e.Fragment,null)},r.renderList=function(t){var n=this;return t.map((function(t){var a=b;switch(null===t.template||0===t.template.length?null!==t.values&&t.values.length>0?(a=x,5!==t.type&&"bool"!==t.type||(a=N)):(1!==t.type&&2!==t.type&&"float"!==t.type&&"double"!==t.type||(a=S),3!==t.type&&4!==t.type&&"int"!==t.type||(a=O)):a=k,a){case b:return e.createElement(P,{key:t.name,name:t.name,displayName:t.displayName,description:t.description,text:""+t.value,OnTextChanged:n.onPropertyChanged});case O:return e.createElement(I,{key:t.name,name:t.name,displayName:t.displayName,description:t.description,value:t.value,OnValueChanged:n.onPropertyChanged,min:t.minimum,max:t.maximum,unit:t.unit||t.Unit,isInteger:!0});case S:return e.createElement(I,{key:t.name,name:t.name,displayName:t.displayName,description:t.description,value:t.value,OnValueChanged:n.onPropertyChanged,min:t.minimum,max:t.maximum,unit:t.unit||t.Unit,isInteger:!1});case x:return e.createElement(L,{key:t.name,name:t.name,displayName:t.displayName,description:t.description,items:t.values,displayStrs:t.displayValues,selectedItem:t.value,OnSelectionChanged:n.onPropertyChanged});case N:return e.createElement(w,{key:t.name,name:t.name,displayName:t.displayName,description:t.description,items:t.values,displayStrs:t.displayValues,bool:t.value,OnBoolChanged:n.onPropertyChanged});case k:return e.createElement(B,{key:t.name,name:t.name,displayName:t.displayName,template:t.template,items:t.parameters,OnListChanged:n.onPropertyChanged});default:return null}}))},r.render=function(){return e.createElement("div",{style:{width:"100%",height:"100%"}},e.createElement("div",{style:{padding:2,width:"100%",height:"100%",overflow:"auto"}},this.renderGroup()))},n}(t);_.defaultProps={params:null,OnSetPropertyList:function(){}},_.propTypes={params:p.array,OnSetPropertyList:p.func,OnParamsChanged:p.func.isRequired};export default h;export{g as AnotherButton,_ as PropertyList};
